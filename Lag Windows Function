--Trelleborg SQL Interview Question - LAG Function
create table salesdata(month varchar(50), 
                       ytd_sales int, 
                       monthnum int);
insert into salesdata values('jan',15,1),
                            ('feb',22,2),
                            ('mar',35,3),
                            ('apr',45,4),
                            ('may',60,5);
SELECT * FROM salesdata;

--SOLUTION
with cte as (
select *,lag(ytd_sales,1,0) over(order by monthnum asc) as lagsales from salesdata ) 
select month,ytd_sales,(ytd_sales-lagsales) as periodicsales from cte;

